{% extends 'rome/base.html' %}
{% load markdown_filters %}
{% block content %}
    <div class="card mb-4">
        <div class="card-body">
            <figure>
                <img src="{{ itineraire.image.url }}" class="card-img-top float-{{ itineraire.image_position }}" alt="{{ itineraire.title }}">
                <figcaption class="card-img-caption">
                    <!-- Ajoutez votre description d'image ici -->
                    {{ itineraire.image_description }}
                </figcaption>
            </figure>
            <h2 class="card-title">{{ itineraire.title }}</h2>
            <p class="card-text meta">Publié le {{ itineraire.date|date:"j F Y" }} par <a href="{% url 'author_detail' pk=itineraire.author.id %}">{{ itineraire.author.name }}</a></p>
            <p class="card-text">{{ itineraire.content|markdown|safe }}</p>
            <div class="itineraire-mymaps">
                <!-- Espace pour afficher l'itinéraire depuis MyMaps -->
                <iframe width="100%" height="400" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="{{ itineraire.map_link }}"></iframe>
            </div>
            <button class="btn btn-primary" id="like-btn" data-article-id="{{ itineraire.id }}">
                <i class="bi bi-hand-thumbs-up"></i> Like
            </button>
            <span id="likes-count" class="ms-2">{{ itineraire.likes }}</span> Likes
        </div>
    </div>
    {% include 'rome/comment.html' %}
    <script>
        // Script jQuery pour gérer le clic sur le bouton Like
        $(document).ready(function() {
            $("#like-btn").on("click", function() {
                var articleId = $(this).data("article-id");
                $.ajax({
                    url: `/like_article/${articleId}/`,
                    method: "POST",
                    dataType: "json",
                    success: function(data) {
                        $("#likes-count").text(data.likes);
                    },
                    error: function(error) {
                        console.log("Error:", error);
                    }
                });
            });
        });
    </script>
{% endblock %}